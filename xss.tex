\chapter{Cross Site Scripting Attacks}

\section{Reflected XSS}

\section{Persistent XSS}

\subsection{Observation}

We discovered that the field "Name" in sc-course/views/users/register.php is vulnerable to persistent Cross-Site-Scripting(XSS) with the following steps:
\begin{enumerate}
 \item Go to sc-course/views/users/register.php
 \item Insert malicious js code in textfield
\end{enumerate}
 If the Admin goes to sc-course/views/approve\_users.php the user information about new registrations are  loaded out of the database. In our case the malicious code is executed when displaying the name.

There are many possibilities to exploit this vulnerability. For example the admin could be redirected to a fake site where all his inputs will be stored.\newline


Likelihood: high \newline

Impact: medium-high\newline

Risk: high\newline

\subsection{Discovery}

This vulnerability was discovered by simply testing the possible inputs for all text fields. By inserting a simple alert() command, we checked if our input was sanitized before inserted into the database. Obviously that's not the case for the name field. This vulnerability was not detected by \texit{wapiti}, which is especially searching for possible XSS attacks.

\subsection{Likelihood}
Exploiting this vulnerability requires basic technical skills. The attacker has to know about the basics of a XSS attack and basic java-script commands. It is possible to exploit this vulnerability from Internet as normal user.

\subsection{Implication}
There are multiple possible implication of a successful attack.  In combination with the unset HTTP\_ONLY flag  the attacker can perform an session hijacking  attack. For that, the attacker uses the XSS attack to sent the current admin's session key session to himself. That's possible due to the unset HTTP\_ONLY-flag.  Therefore the session key can be accessed by the javascript command \"documnet.cookie\". Now the attacker can use this session key to bypass the authentication and act as the admin. 

The unset HTTP\_ONLY-flag  was discovered by the tool ZAP.
The attacker could also create a duplicate of the website to that the admin is redirected without even noticing. In that way, the attacker could record all inputs made by the admin.



\subsection{Recommendations}
To prevent Cross-Site-Scripting attacks, the user input has to be sanitized before inserted into the database. Go to \url{https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)} for more information. \newline
This observation relates to the OWASP Top-10 issues A3 - Cross-Site-Scripting

\subsection{Comparison with our App}
We avoided persistent XSS attacks by using PHP Data Objects (PDO) to query the database. 
This includes the usage of prepared statements, so that 
inputs are automatically sanitized.